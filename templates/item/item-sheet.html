<form class="{{cssClass}} {{item.type}} flexcol" autocomplete="off">

  {{!-- Item Sheet Header --}}
  <header class="sheet-header">
    <img class="profile-img" src="{{item.img}}" data-edit="img" title="{{item.name}}" height="64" width="64"/>
    <div class="header-fields">
      <h1 class="charname"><input name="name" type="text" value="{{item.name}}" placeholder="Item Name"/></h1>
    </div>
  </header>

  {{!-- Item Sheet Navigation --}}
  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="description">Description</a>
    <a class="item" data-tab="details">Details</a>
  </nav>

  {{!-- Item Sheet Body --}}
  <section class="sheet-body">

    {{!-- Description Tab --}}
    <div class="tab" data-group="primary" data-tab="description">
      <textarea name="system.description" rows="20" placeholder="Item description...">{{system.description}}</textarea>
    </div>

    {{!-- Details Tab --}}
    <div class="tab" data-group="primary" data-tab="details">
      <div class="form-group">
        <label>Quantity</label>
        <input type="number" name="system.quantity" value="{{system.quantity}}" data-dtype="Number"/>
      </div>
      
      <div class="form-group">
        <label>Weight</label>
        <input type="number" name="system.weight" value="{{system.weight}}" data-dtype="Number" step="0.1"/>
      </div>
      
      <div class="form-group">
        <label>Price (¥)</label>
        <input type="number" name="system.price" value="{{system.price}}" data-dtype="Number"/>
      </div>

      {{#if (eq item.type "skill")}}
      <div class="form-group">
        <label>Rating</label>
        <input type="number" name="system.rating" value="{{system.rating}}" data-dtype="Number"/>
      </div>
      
      <div class="form-group">
        <label>Linked Attribute</label>
        <select name="system.attribute" data-dtype="String">
          <option value="body" {{#if (eq system.attribute "body")}}selected{{/if}}>Body</option>
          <option value="quickness" {{#if (eq system.attribute "quickness")}}selected{{/if}}>Quickness</option>
          <option value="strength" {{#if (eq system.attribute "strength")}}selected{{/if}}>Strength</option>
          <option value="charisma" {{#if (eq system.attribute "charisma")}}selected{{/if}}>Charisma</option>
          <option value="intelligence" {{#if (eq system.attribute "intelligence")}}selected{{/if}}>Intelligence</option>
          <option value="willpower" {{#if (eq system.attribute "willpower")}}selected{{/if}}>Willpower</option>
        </select>
      </div>
      {{/if}}

      {{#if (eq item.type "weapon")}}
      <div class="form-group">
        <label>Weapon Type</label>
        <select name="system.weaponType" data-dtype="String">
          <option value="melee" {{#if (eq system.weaponType "melee")}}selected{{/if}}>Melee</option>
          <option value="ranged" {{#if (eq system.weaponType "ranged")}}selected{{/if}}>Ranged</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>Damage Code</label>
        <input type="text" name="system.damage" value="{{system.damage}}" placeholder="e.g. 6M"/>
      </div>
      
      <div class="form-group">
        <label>Concealability</label>
        <input type="number" name="system.concealability" value="{{system.concealability}}" data-dtype="Number"/>
      </div>
      
      {{#if (eq system.weaponType "melee")}}
      <div class="form-group">
        <label>Reach</label>
        <input type="number" name="system.reach" value="{{system.reach}}" data-dtype="Number"/>
      </div>
      {{/if}}
      
      {{#if (eq system.weaponType "ranged")}}
      <div class="form-group">
        <label>Mode</label>
        <input type="text" name="system.mode" value="{{system.mode}}" placeholder="e.g. SS, SA, BF, FA"/>
      </div>
      
      <div class="form-group">
        <label>Ammo Capacity</label>
        <input type="number" name="system.ammo.max" value="{{system.ammo.max}}" data-dtype="Number"/>
      </div>
      
      <div class="form-group">
        <label>Current Ammo</label>
        <input type="number" name="system.ammo.current" value="{{system.ammo.current}}" data-dtype="Number"/>
      </div>
      
      <div class="form-group">
        <label>Recoil</label>
        <input type="number" name="system.recoil" value="{{system.recoil}}" data-dtype="Number"/>
      </div>
      
      <div class="form-group">
        <label>Range Type</label>
        <select name="system.rangeType" data-dtype="String">
          <option value="" {{#unless system.rangeType}}selected{{/unless}}>Select Range Type</option>
          <option value="pistol" {{#if (eq system.rangeType "pistol")}}selected{{/if}}>Pistol</option>
          <option value="smg" {{#if (eq system.rangeType "smg")}}selected{{/if}}>SMG</option>
          <option value="rifle" {{#if (eq system.rangeType "rifle")}}selected{{/if}}>Rifle</option>
          <option value="shotgun" {{#if (eq system.rangeType "shotgun")}}selected{{/if}}>Shotgun</option>
          <option value="bow" {{#if (eq system.rangeType "bow")}}selected{{/if}}>Bow</option>
          <option value="crossbow" {{#if (eq system.rangeType "crossbow")}}selected{{/if}}>Crossbow</option>
        </select>
      </div>
      {{/if}}
      
      <div class="form-group">
        <label>Equipped</label>
        <input type="checkbox" name="system.equipped" {{#if system.equipped}}checked{{/if}}/>
      </div>
      
      <hr>
      <h3>Skill Linking</h3>
      <div class="form-group">
        <label>Linked Skill</label>
        <select name="system.linkedSkill.skillId" data-dtype="String" class="weapon-skill-select">
          <option value="">No Skill Linked</option>
          {{#each availableSkills as |skill|}}
            <option value="{{skill._id}}" {{#if (eq skill._id system.linkedSkill.skillId)}}selected{{/if}}>
              {{skill.name}}{{#if skill.system.baseSkill}} ({{skill.system.baseSkill}}){{/if}}
            </option>
          {{/each}}
        </select>
      </div>
      
      <div class="form-group">
        <label>Roll Type</label>
        <select name="system.linkedSkill.rollType" data-dtype="String">
          <option value="base" {{#if (eq system.linkedSkill.rollType "base")}}selected{{/if}}>Base Skill</option>
          <option value="concentration" {{#if (eq system.linkedSkill.rollType "concentration")}}selected{{/if}}>Concentration</option>
          <option value="specialization" {{#if (eq system.linkedSkill.rollType "specialization")}}selected{{/if}}>Specialization</option>
        </select>
      </div>
      {{/if}}

      {{#if (eq item.type "armor")}}
      <div class="form-group">
        <label>Ballistic Rating</label>
        <input type="number" name="system.ballistic" value="{{system.ballistic}}" data-dtype="Number" min="0"/>
      </div>
      
      <div class="form-group">
        <label>Impact Rating</label>
        <input type="number" name="system.impact" value="{{system.impact}}" data-dtype="Number" min="0"/>
      </div>
      
      <div class="form-group">
        <label>Concealability</label>
        <input type="number" name="system.concealability" value="{{system.concealability}}" data-dtype="Number"/>
      </div>
      
      <div class="form-group">
        <label>Equipped</label>
        <input type="checkbox" name="system.equipped" {{#if system.equipped}}checked{{/if}}/>
      </div>
      {{/if}}

      {{#if (eq item.type "program")}}
      <div class="form-group">
        <label>Rating</label>
        <input type="number" name="system.rating" value="{{system.rating}}" data-dtype="Number" min="1" max="12"/>
      </div>
      
      <div class="form-group">
        <label>Program Type</label>
        <select name="system.type" data-dtype="String">
          <option value="utility" {{#if (eq system.type "utility")}}selected{{/if}}>Utility</option>
          <option value="attack" {{#if (eq system.type "attack")}}selected{{/if}}>Attack</option>
          <option value="defense" {{#if (eq system.type "defense")}}selected{{/if}}>Defense</option>
          <option value="detection" {{#if (eq system.type "detection")}}selected{{/if}}>Detection</option>
          <option value="operation" {{#if (eq system.type "operation")}}selected{{/if}}>Operation</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>Size Multiplier</label>
        <input type="number" name="system.multiplier" value="{{system.multiplier}}" data-dtype="Number" min="1" step="0.1"/>
        <small>Size = (Rating × Rating) × Multiplier</small>
      </div>
      
      <div class="form-group">
        <label>Calculated Memory Size (MP)</label>
        <input type="number" name="system.memorySize" value="{{system.memorySize}}" data-dtype="Number" min="1" readonly/>
        <small>Auto-calculated from rating and multiplier</small>
      </div>
      
      <div class="form-group">
        <label>Load Time</label>
        <input type="number" name="system.loadTime" value="{{system.loadTime}}" data-dtype="Number" min="1"/>
      </div>
      
      <div class="form-group">
        <label>Availability</label>
        <input type="text" name="system.availability" value="{{system.availability}}" placeholder="e.g. 4/7days"/>
      </div>
      
      <div class="form-group">
        <label>Street Index</label>
        <input type="number" name="system.streetIndex" value="{{system.streetIndex}}" data-dtype="Number" step="0.1" min="0"/>
      </div>
      {{/if}}

    </div>

  </section>
</form>